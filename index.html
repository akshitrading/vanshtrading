
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ETH 5-Min Signals</title>
  <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
      background-color: #000;
    }
    #container {
      height: 100vh;
    }
  </style>
</head>
<body>
  <div id="container"></div>
  <script type="text/javascript">
    new TradingView.widget({
      autosize: true,
      symbol: "BINANCE:ETHUSDT",
      interval: "5",
      timezone: "Etc/UTC",
      theme: "dark",
      style: "1",
      locale: "en",
      toolbar_bg: "#f1f3f6",
      enable_publishing: false,
      allow_symbol_change: true,
      container_id: "container",
      studies_overrides: {},
      studies: [],
      overrides: {
        "mainSeriesProperties.style": 1
      },
      custom_indicators_getter: function (PineJS) {
        return Promise.resolve([
          {
            name: "BuySellSignal",
            metainfo: {
              _metainfoVersion: 40,
              id: "BuySellSignal@tv-basic",
              name: "BuySellSignal",
              description: "Buy Sell Signal",
              is_hidden_study: false,
              is_price_study: true,
              plots: [
                { id: "plot_0", type: "shape", title: "Signal" }
              ],
              styles: {
                plot_0: {
                  title: "Signal",
                  shape: "arrow_up",
                  location: "belowbar",
                  color: "#00ff00",
                  size: 1
                }
              },
              defaults: {
                styles: {
                  plot_0: {
                    color: "#00ff00",
                    width: 1,
                    style: 0,
                    visible: true
                  }
                }
              },
              inputs: []
            },
            constructor: function () {
              return {
                init: function (context, input) {
                  this._context = context;
                  this._input = input;
                  this._context.new_var("close");
                },
                main: function (context, input) {
                  const c = context;
                  const close = c.close;

                  const signal = [];

                  for (let i = 20; i < close.length; i++) {
                    const trendUp = close[i] > close[i - 1];
                    const trendDown = close[i] < close[i - 1];

                    let upCount = 0;
                    let downCount = 0;

                    for (let j = 0; j < 3; j++) {
                      if (close[i - j] > close[i - j - 1]) upCount++;
                      if (close[i - j] < close[i - j - 1]) downCount++;
                    }

                    if (upCount === 3) {
                      signal[i] = { shape: "arrow_up", text: "Buy" };
                    } else if (downCount === 3) {
                      signal[i] = { shape: "arrow_down", text: "Sell" };
                    } else {
                      signal[i] = null;
                    }
                  }

                  return [signal];
                }
              };
            }
          }
        ]);
      }
    });
  </script>
</body>
</html>
